THREE.DDSLoader=function(){this._parser=THREE.DDSLoader.parse};THREE.DDSLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype);THREE.DDSLoader.prototype.constructor=THREE.DDSLoader;
THREE.DDSLoader.parse=function(m,t){function k(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function u(a,b,c,d){var g=c*d*4;a=new Uint8Array(a,b,g);for(var g=new Uint8Array(g),h=b=0,e=0;e<d;e++)for(var f=0;f<c;f++){var k=a[h];h++;var l=a[h];h++;var m=a[h];h++;var n=a[h];h++;g[b]=m;b++;g[b]=l;b++;g[b]=k;b++;g[b]=n;b++}return g}var a={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},e=k("DXT1"),c=k("DXT3"),l=k("DXT5"),f=k("ETC1"),b=new Int32Array(m,
0,31);if(542327876!==b[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),a;if(!b[20]&4)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),a;var d=b[21],q=!1;switch(d){case e:e=8;a.format=THREE.RGB_S3TC_DXT1_Format;break;case c:e=16;a.format=THREE.RGBA_S3TC_DXT3_Format;break;case l:e=16;a.format=THREE.RGBA_S3TC_DXT5_Format;break;case f:e=8;a.format=THREE.RGB_ETC1_Format;break;default:if(32===b[22]&&b[23]&16711680&&b[24]&
65280&&b[25]&255&&b[26]&4278190080)q=!0,e=64,a.format=THREE.RGBAFormat;else return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",String.fromCharCode(d&255,d>>8&255,d>>16&255,d>>24&255)),a}a.mipmapCount=1;b[2]&131072&&!1!==t&&(a.mipmapCount=Math.max(1,b[7]));c=b[28];a.isCubemap=c&512?!0:!1;if(a.isCubemap&&!(c&1024&&c&2048&&c&4096&&c&8192&&c&16384&&c&32768))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),a;a.width=b[4];a.height=b[3];b=b[1]+4;c=a.isCubemap?6:
1;for(l=0;l<c;l++)for(var f=a.width,d=a.height,r=0;r<a.mipmapCount;r++){if(q)var n=u(m,b,f,d),p=n.length;else p=Math.max(4,f)/4*Math.max(4,d)/4*e,n=new Uint8Array(m,b,p);a.mipmaps.push({data:n,width:f,height:d});b+=p;f=Math.max(f>>1,1);d=Math.max(d>>1,1)}return a};
