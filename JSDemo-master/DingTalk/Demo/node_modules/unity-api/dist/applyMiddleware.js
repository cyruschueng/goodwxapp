'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = applyMiddleware;
function applyMiddleware(applyTo) {
    var middlewares = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
    var params = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
    var resourceId = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : '';
    var type = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : '';


    middlewares = [].concat(middlewares).filter(function (func) {
        return typeof func === 'function';
    });

    if (!middlewares.length) {
        return applyTo(params);
    }

    return middlewares.reduceRight(function (prev, middleware, index) {

        var next = index === middlewares.length - 1 ? prev.bind(null, params) : prev.bind(null, options, params, resourceId, type);

        return index === 0 ? middleware(next)(options, params, resourceId, type) : middleware(next);
    }, applyTo);
}